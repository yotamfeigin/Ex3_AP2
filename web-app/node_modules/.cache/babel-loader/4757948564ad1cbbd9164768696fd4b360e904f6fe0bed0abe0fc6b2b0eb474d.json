{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/yuval/Documents/GitHub/ex2_mitkadem2/web-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/yuval/Documents/GitHub/ex2_mitkadem2/web-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/yuval/Documents/GitHub/ex2_mitkadem2/web-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Link,useNavigate}from'react-router-dom';import TextInput from'../register/TextInput';import PasswordInput from'../register/PasswordInput';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LoginPage(_ref){var setLoginStatus=_ref.setLoginStatus,setCurrentUser=_ref.setCurrentUser,userList=_ref.userList,usernameList=_ref.usernameList,setContacts=_ref.setContacts,setDisplayName=_ref.setDisplayName,setUserImage=_ref.setUserImage;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var navigate=useNavigate();var login=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var UserLogin,res,token,getUserResponse,userJson,_username,displayName,profilePic;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:UserLogin={\"username\":username,\"password\":password};_context.next=3;return fetch('http://localhost:5000/api/Tokens',{method:'post',headers:{'Content-Type':'application/json'},body:JSON.stringify(UserLogin)});case 3:res=_context.sent;if(!res.ok){_context.next=23;break;}_context.next=7;return res.text();case 7:token=_context.sent;// Use the token here\nconsole.log(token);_context.next=11;return fetch(\"http://localhost:5000/api/Users/\".concat(username),{method:'get',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)}});case 11:getUserResponse=_context.sent;if(!getUserResponse.ok){_context.next=20;break;}_context.next=15;return getUserResponse.json();case 15:userJson=_context.sent;// Extract the values from the JSON response\n_username=userJson.username,displayName=userJson.displayName,profilePic=userJson.profilePic;// Use the extracted values\nconsole.log(_username,displayName,profilePic);_context.next=21;break;case 20:// Handle error cases for GET request\nconsole.log('Error:',getUserResponse.status);case 21:_context.next=24;break;case 23:// Handle error cases for POST request\nconsole.log('Username or password are wrong',res.status);case 24:case\"end\":return _context.stop();}},_callee);}));return function login(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"login\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"login\",children:[/*#__PURE__*/_jsx(TextInput,{className:\"username-login\",userList:userList,usernameList:usernameList,username:username,setUsername:setUsername}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(PasswordInput,{className:\"password-login\",password:password,setPassword:setPassword})}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline-light btn-sm textColor\",onClick:login,children:\"Login\"}),\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"small\",{className:\"textColor\",children:[\"Don't have an account yet? \",/*#__PURE__*/_jsx(Link,{className:\"textColor\",to:\"/register\",children:\"Register\"})]})]})})});}export default LoginPage;","map":{"version":3,"names":["React","useState","Link","useNavigate","TextInput","PasswordInput","jsx","_jsx","jsxs","_jsxs","LoginPage","_ref","setLoginStatus","setCurrentUser","userList","usernameList","setContacts","setDisplayName","setUserImage","_useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","navigate","login","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","UserLogin","res","token","getUserResponse","userJson","_username","displayName","profilePic","wrap","_callee$","_context","prev","next","fetch","method","headers","body","JSON","stringify","sent","ok","text","console","log","concat","json","status","stop","_x","apply","arguments","children","className","type","onClick","to"],"sources":["C:/Users/yuval/Documents/GitHub/ex2_mitkadem2/web-app/src/login/LoginPage.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport TextInput from '../register/TextInput';\r\nimport PasswordInput from '../register/PasswordInput';\r\n\r\n\r\nfunction LoginPage({ setLoginStatus, setCurrentUser, userList, usernameList, setContacts, setDisplayName, setUserImage }) {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const login = async (event) => {\r\n    var UserLogin = {\r\n      \"username\": username,\r\n      \"password\": password\r\n    };\r\n  \r\n    const res = await fetch('http://localhost:5000/api/Tokens', {\r\n      method: 'post',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(UserLogin)\r\n    });\r\n  \r\n    if (res.ok) {\r\n      const token = await res.text();\r\n      // Use the token here\r\n      console.log(token);\r\n  \r\n      const getUserResponse = await fetch(`http://localhost:5000/api/Users/${username}`, {\r\n        method: 'get',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n  \r\n      if (getUserResponse.ok) {\r\n        const userJson = await getUserResponse.json();\r\n        // Extract the values from the JSON response\r\n        const { username, displayName, profilePic } = userJson;\r\n        // Use the extracted values\r\n        console.log(username, displayName, profilePic);\r\n      } else {\r\n        // Handle error cases for GET request\r\n        console.log('Error:', getUserResponse.status);\r\n      }\r\n    } else {\r\n      // Handle error cases for POST request\r\n      console.log('Username or password are wrong', res.status);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <main>\r\n      <div className=\"login\">\r\n        <form className=\"login\">\r\n          <TextInput className=\"username-login\" userList={userList} usernameList={usernameList} username={username} setUsername={setUsername} />\r\n          <div className=\"form-group\">\r\n            <PasswordInput className=\"password-login\" password={password} setPassword={setPassword} />\r\n          </div>\r\n          <button type=\"button\" className=\"btn btn-outline-light btn-sm textColor\" onClick={login}>Login</button> <br />\r\n          <small className=\"textColor\">Don't have an account yet? <Link className=\"textColor\" to=\"/register\">Register</Link></small>\r\n        </form>\r\n\r\n      </div>\r\n    </main>\r\n\r\n\r\n  );\r\n}\r\n\r\n\r\nexport default LoginPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}